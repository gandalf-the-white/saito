<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="1001px" preserveAspectRatio="none" style="width:1755px;height:1001px;background:#FFFFFF;" version="1.1" viewBox="0 0 1755 1001" width="1755px" zoomAndPan="magnify"><defs/><g><!--cluster mcp-client--><g class="cluster" data-entity="mcp-client" data-source-line="6" data-uid="ent0002" id="cluster_mcp-client"><path d="M8.5,6 L88.373,6 A3.75,3.75 0 0 1 90.873,8.5 L97.873,28.4883 L1432.5,28.4883 A2.5,2.5 0 0 1 1435,30.9883 L1435,991.86 A2.5,2.5 0 0 1 1432.5,994.36 L8.5,994.36 A2.5,2.5 0 0 1 6,991.86 L6,8.5 A2.5,2.5 0 0 1 8.5,6" fill="#E8F5E9" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="97.873" y1="28.4883" y2="28.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78.873" x="10" y="21.5352">mcp-client</text></g><!--class Configuration--><g class="entity" data-entity="Configuration" data-source-line="8" data-uid="ent0003" id="entity_Configuration"><rect fill="#F1F1F1" height="155.5508" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="244.6885" x="1137.66" y="672.7"/><ellipse cx="1198.5453" cy="693.0105" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1201.0184,699.1536 Q1200.4373,699.4524 1199.7982,699.6019 Q1199.159,699.7513 1198.4535,699.7513 Q1195.9466,699.7513 1194.6268,698.0994 Q1193.307,696.4476 1193.307,693.3265 Q1193.307,690.1971 1194.6268,688.5452 Q1195.9466,686.8934 1198.4535,686.8934 Q1199.159,686.8934 1199.8065,687.0428 Q1200.4539,687.1922 1201.0184,687.491 L1201.0184,690.2137 Q1200.3875,689.6326 1199.794,689.3628 Q1199.2005,689.0931 1198.5697,689.0931 Q1197.2249,689.0931 1196.5401,690.1597 Q1195.8553,691.2264 1195.8553,693.3265 Q1195.8553,695.4183 1196.5401,696.4849 Q1197.2249,697.5516 1198.5697,697.5516 Q1199.2005,697.5516 1199.794,697.2818 Q1200.3875,697.012 1201.0184,696.431 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="118.418" x="1217.0453" y="689.3016">&#171;Global Parameters&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.6182" x="1229.4452" y="705.368">Configuration</text><line style="stroke:#181818;stroke-width:0.5;" x1="1138.66" x2="1381.3485" y1="713.3211" y2="713.3211"/><ellipse cx="1148.66" cy="727.0652" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.1406" x="1157.66" y="730.8562">*ollama-url* : string</text><ellipse cx="1148.66" cy="743.5535" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162.0049" x="1157.66" y="747.3445">*ollama-model* : string</text><ellipse cx="1148.66" cy="760.0418" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121.9668" x="1157.66" y="763.8328">*mcp-url* : string</text><ellipse cx="1148.66" cy="776.5301" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="218.6885" x="1157.66" y="780.3211">*agent-system-prompt* : string</text><ellipse cx="1148.66" cy="793.0184" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.9014" x="1157.66" y="796.8094">*debug* : boolean</text><ellipse cx="1148.66" cy="809.5066" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163.2354" x="1157.66" y="813.2977">*mcp-next-id* : integer</text><line style="stroke:#181818;stroke-width:0.5;" x1="1138.66" x2="1381.3485" y1="820.2508" y2="820.2508"/></g><!--class REPL--><g class="entity" data-entity="REPL" data-source-line="17" data-uid="ent0004" id="entity_REPL"><rect fill="#BBDEFB" height="122.5742" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="233.4365" x="917.28" y="41"/><ellipse cx="1000.0315" cy="61.3105" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1002.5046,67.4536 Q1001.9236,67.7524 1001.2844,67.9019 Q1000.6452,68.0513 999.9397,68.0513 Q997.4328,68.0513 996.113,66.3994 Q994.7932,64.7476 994.7932,61.6265 Q994.7932,58.4971 996.113,56.8452 Q997.4328,55.1934 999.9397,55.1934 Q1000.6452,55.1934 1001.2927,55.3428 Q1001.9402,55.4922 1002.5046,55.791 L1002.5046,58.5137 Q1001.8738,57.9326 1001.2802,57.6628 Q1000.6867,57.3931 1000.0559,57.3931 Q998.7112,57.3931 998.0263,58.4597 Q997.3415,59.5264 997.3415,61.6265 Q997.3415,63.7183 998.0263,64.7849 Q998.7112,65.8516 1000.0559,65.8516 Q1000.6867,65.8516 1001.2802,65.5818 Q1001.8738,65.312 1002.5046,64.731 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.4336" x="1018.5315" y="57.6016">&#171;Interface&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.6436" x="1034.4265" y="73.668">REPL</text><line style="stroke:#181818;stroke-width:0.5;" x1="918.28" x2="1149.7165" y1="81.6211" y2="81.6211"/><line style="stroke:#181818;stroke-width:0.5;" x1="918.28" x2="1149.7165" y1="89.6211" y2="89.6211"/><ellipse cx="928.28" cy="103.3652" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="207.4365" x="937.28" y="107.1563">run-mcp-ollama-repl(prompt)</text><ellipse cx="928.28" cy="119.8535" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.6426" x="937.28" y="123.6445">main()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="925.28" y="133.3418"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160.4805" x="937.28" y="140.1328">handle-user-input(line)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="925.28" y="149.8301"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204.3945" x="937.28" y="156.6211">handle-commands(command)</text></g><!--class Agent--><g class="entity" data-entity="Agent" data-source-line="24" data-uid="ent0005" id="entity_Agent"><rect fill="#BBDEFB" height="139.0625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="333.1182" x="1085.44" y="240.57"/><ellipse cx="1214.2501" cy="260.8805" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M1216.7232,267.0236 Q1216.1421,267.3224 1215.503,267.4719 Q1214.8638,267.6213 1214.1583,267.6213 Q1211.6514,267.6213 1210.3316,265.9694 Q1209.0118,264.3176 1209.0118,261.1965 Q1209.0118,258.0671 1210.3316,256.4152 Q1211.6514,254.7634 1214.1583,254.7634 Q1214.8638,254.7634 1215.5113,254.9128 Q1216.1588,255.0622 1216.7232,255.361 L1216.7232,258.0837 Q1216.0923,257.5026 1215.4988,257.2328 Q1214.9053,256.9631 1214.2745,256.9631 Q1212.9297,256.9631 1212.2449,258.0297 Q1211.5601,259.0964 1211.5601,261.1965 Q1211.5601,263.2883 1212.2449,264.3549 Q1212.9297,265.4216 1214.2745,265.4216 Q1214.9053,265.4216 1215.4988,265.1518 Q1216.0923,264.882 1216.7232,264.301 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="70.998" x="1232.7501" y="257.1716">&#171;Controller&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.1133" x="1248.1924" y="273.238">Agent</text><line style="stroke:#181818;stroke-width:0.5;" x1="1086.44" x2="1417.5582" y1="281.1911" y2="281.1911"/><line style="stroke:#181818;stroke-width:0.5;" x1="1086.44" x2="1417.5582" y1="289.1911" y2="289.1911"/><ellipse cx="1096.44" cy="302.9352" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="307.1182" x="1105.44" y="306.7263">run-mcp-ollama-session(user-input) : string</text><ellipse cx="1096.44" cy="319.4235" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.4902" x="1105.44" y="323.2145">mcp-print-tools()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1093.44" y="332.9118"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232.4082" x="1105.44" y="339.7028">build-message-history(messages)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1093.44" y="349.4001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199.0215" x="1105.44" y="356.1911">process-tool-calls(tool-calls)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="1093.44" y="365.8884"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185.4453" x="1105.44" y="372.6794">execute-tool-call(tool-call)</text></g><!--class OllamaClient--><g class="entity" data-entity="OllamaClient" data-source-line="32" data-uid="ent0006" id="entity_OllamaClient"><rect fill="#BBDEFB" height="122.5742" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="386.2881" x="284.86" y="464.88"/><ellipse cx="430.2501" cy="485.1905" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M432.7233,491.3336 Q432.1422,491.6324 431.5031,491.7819 Q430.8639,491.9313 430.1583,491.9313 Q427.6515,491.9313 426.3317,490.2794 Q425.0119,488.6276 425.0119,485.5065 Q425.0119,482.3771 426.3317,480.7252 Q427.6515,479.0734 430.1583,479.0734 Q430.8639,479.0734 431.5114,479.2228 Q432.1588,479.3722 432.7233,479.671 L432.7233,482.3937 Q432.0924,481.8126 431.4989,481.5428 Q430.9054,481.2731 430.2746,481.2731 Q428.9298,481.2731 428.245,482.3397 Q427.5602,483.4064 427.5602,485.5065 Q427.5602,487.5983 428.245,488.6649 Q428.9298,489.7316 430.2746,489.7316 Q430.9054,489.7316 431.4989,489.4618 Q432.0924,489.192 432.7233,488.611 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="68.6016" x="459.9533" y="481.4816">&#171;API Client&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0078" x="450.7501" y="497.548">OllamaClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="285.86" x2="670.1481" y1="505.5011" y2="505.5011"/><line style="stroke:#181818;stroke-width:0.5;" x1="285.86" x2="670.1481" y1="513.5011" y2="513.5011"/><ellipse cx="295.86" cy="527.2452" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="360.2881" x="304.86" y="531.0363">call-ollama-with-tools(messages, tools) : hash-table</text><ellipse cx="295.86" cy="543.7335" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="290.582" x="304.86" y="547.5245">mcp-tools-&gt;ollama-tools(mcp-tools) : list</text><ellipse cx="295.86" cy="560.2218" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="296.6387" x="304.86" y="564.0128">parse-arguments-maybe(args) : hash-table</text><ellipse cx="295.86" cy="576.7101" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.8564" x="304.86" y="580.5011">ensure-list(x) : list</text></g><!--class MCPHttpClient--><g class="entity" data-entity="MCPHttpClient" data-source-line="39" data-uid="ent0007" id="entity_MCPHttpClient"><rect fill="#BBDEFB" height="139.0625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="358.0693" x="810.97" y="456.64"/><ellipse cx="936.4744" cy="476.9505" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M938.9475,483.0936 Q938.3665,483.3924 937.7273,483.5419 Q937.0882,483.6913 936.3826,483.6913 Q933.8758,483.6913 932.5559,482.0394 Q931.2361,480.3876 931.2361,477.2665 Q931.2361,474.1371 932.5559,472.4852 Q933.8758,470.8334 936.3826,470.8334 Q937.0882,470.8334 937.7356,470.9828 Q938.3831,471.1322 938.9475,471.431 L938.9475,474.1537 Q938.3167,473.5726 937.7232,473.3028 Q937.1297,473.0331 936.4988,473.0331 Q935.1541,473.0331 934.4693,474.0997 Q933.7845,475.1664 933.7845,477.2665 Q933.7845,479.3583 934.4693,480.4249 Q935.1541,481.4916 936.4988,481.4916 Q937.1297,481.4916 937.7232,481.2218 Q938.3167,480.952 938.9475,480.371 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="68.6016" x="971.9539" y="473.2416">&#171;API Client&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.5605" x="956.9744" y="489.308">MCPHttpClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="811.97" x2="1168.0393" y1="497.2611" y2="497.2611"/><line style="stroke:#181818;stroke-width:0.5;" x1="811.97" x2="1168.0393" y1="505.2611" y2="505.2611"/><ellipse cx="821.97" cy="519.0052" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="332.0693" x="830.97" y="522.7963">mcp-http-request(method, params) : hash-table</text><ellipse cx="821.97" cy="535.4935" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.2012" x="830.97" y="539.2845">mcp-tools-list() : list</text><ellipse cx="821.97" cy="551.9818" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="270.8125" x="830.97" y="555.7728">mcp-tools-list-text(conn-ignored) : list</text><ellipse cx="821.97" cy="568.4701" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="303.4268" x="830.97" y="572.2611">mcp-call-tool-text(name, args-alist) : string</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="818.97" y="581.9584"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.8467" x="830.97" y="588.7494">mcp-next-id() : integer</text></g><!--class HttpUtils--><g class="entity" data-entity="HttpUtils" data-source-line="47" data-uid="ent0008" id="entity_HttpUtils"><rect fill="#BBDEFB" height="106.0859" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="307.2715" x="324.36" y="697.43"/><ellipse cx="443.8761" cy="717.7405" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M446.3493,723.8836 Q445.7682,724.1824 445.129,724.3319 Q444.4899,724.4813 443.7843,724.4813 Q441.2775,724.4813 439.9577,722.8294 Q438.6378,721.1776 438.6378,718.0565 Q438.6378,714.9271 439.9577,713.2752 Q441.2775,711.6234 443.7843,711.6234 Q444.4899,711.6234 445.1373,711.7728 Q445.7848,711.9222 446.3493,712.221 L446.3493,714.9437 Q445.7184,714.3626 445.1249,714.0928 Q444.5314,713.8231 443.9005,713.8231 Q442.5558,713.8231 441.871,714.8897 Q441.1862,715.9564 441.1862,718.0565 Q441.1862,720.1483 441.871,721.2149 Q442.5558,722.2816 443.9005,722.2816 Q444.5314,722.2816 445.1249,722.0118 Q445.7184,721.742 446.3493,721.161 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="46.541" x="470.9752" y="714.0316">&#171;Utility&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.7393" x="464.3761" y="730.098">HttpUtils</text><line style="stroke:#181818;stroke-width:0.5;" x1="325.36" x2="630.6315" y1="738.0511" y2="738.0511"/><line style="stroke:#181818;stroke-width:0.5;" x1="325.36" x2="630.6315" y1="746.0511" y2="746.0511"/><ellipse cx="335.36" cy="759.7952" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="281.2715" x="344.36" y="763.5863">http-post-json(url, payload-alist) : string</text><ellipse cx="335.36" cy="776.2835" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.8311" x="344.36" y="780.0745">body-&gt;string(body) : string</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="332.36" y="789.7718"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="244.3096" x="344.36" y="796.5628">handle-http-response(status, body)</text></g><!--class Logging--><g class="entity" data-entity="Logging" data-source-line="53" data-uid="ent0009" id="entity_Logging"><rect fill="#BBDEFB" height="73.1094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123.0977" x="708.45" y="905.25"/><ellipse cx="739.6992" cy="925.5605" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M742.1724,931.7036 Q741.5913,932.0024 740.9521,932.1519 Q740.313,932.3013 739.6074,932.3013 Q737.1006,932.3013 735.7808,930.6494 Q734.4609,928.9976 734.4609,925.8765 Q734.4609,922.7471 735.7808,921.0952 Q737.1006,919.4434 739.6074,919.4434 Q740.313,919.4434 740.9604,919.5928 Q741.6079,919.7422 742.1724,920.041 L742.1724,922.7637 Q741.5415,922.1826 740.948,921.9128 Q740.3545,921.6431 739.7236,921.6431 Q738.3789,921.6431 737.6941,922.7097 Q737.0093,923.7764 737.0093,925.8765 Q737.0093,927.9683 737.6941,929.0349 Q738.3789,930.1016 739.7236,930.1016 Q740.3545,930.1016 740.948,929.8318 Q741.5415,929.562 742.1724,928.981 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="46.541" x="761.5338" y="921.8516">&#171;Utility&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9883" x="757.3102" y="937.918">Logging</text><line style="stroke:#181818;stroke-width:0.5;" x1="709.45" x2="830.5477" y1="945.8711" y2="945.8711"/><line style="stroke:#181818;stroke-width:0.5;" x1="709.45" x2="830.5477" y1="953.8711" y2="953.8711"/><ellipse cx="719.45" cy="967.6152" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.0977" x="728.45" y="971.4063">dbg(fmt, args)</text></g><!--class External: Ollama API--><g class="entity" data-entity="External. Ollama API" data-source-line="57" data-uid="ent0010" id="entity_External. Ollama API"><rect fill="#F1F1F1" height="139.0625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169.6279" x="120.19" y="680.94"/><ellipse cx="135.19" cy="701.2505" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M131.6177,697.5157 L131.6177,695.3575 L138.9971,695.3575 L138.9971,697.5157 L136.5318,697.5157 L136.5318,705.5923 L138.9971,705.5923 L138.9971,707.7505 L131.6177,707.7505 L131.6177,705.5923 L134.0831,705.5923 L134.0831,697.5157 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="104.4316" x="165.7881" y="697.5416">&#171;External Service&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="137.6279" x="149.19" y="713.608">External: Ollama API</text><line style="stroke:#181818;stroke-width:0.5;" x1="121.19" x2="288.8179" y1="721.5611" y2="721.5611"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.5371" x="126.19" y="739.0962">POST /api/chat</text><line style="stroke:#181818;stroke-width:1;" x1="121.19" x2="288.8179" y1="746.0494" y2="746.0494"/><ellipse cx="131.19" cy="759.7935" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.1836" x="140.19" y="763.5845">model : string</text><ellipse cx="131.19" cy="776.2818" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.0645" x="140.19" y="780.0728">messages : array</text><ellipse cx="131.19" cy="792.7701" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.1426" x="140.19" y="796.5611">tools : array</text><ellipse cx="131.19" cy="809.2584" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.2695" x="140.19" y="813.0494">stream : boolean</text></g><!--class External: MCP Server--><g class="entity" data-entity="External. MCP Server" data-source-line="66" data-uid="ent0011" id="entity_External. MCP Server"><rect fill="#F1F1F1" height="122.5742" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172.0205" x="930.99" y="689.19"/><ellipse cx="945.99" cy="709.5005" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M942.4177,705.7657 L942.4177,703.6075 L949.7971,703.6075 L949.7971,705.7657 L947.3318,705.7657 L947.3318,713.8423 L949.7971,713.8423 L949.7971,716.0005 L942.4177,716.0005 L942.4177,713.8423 L944.8831,713.8423 L944.8831,705.7657 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="104.4316" x="977.7844" y="705.7916">&#171;External Service&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140.0205" x="959.99" y="721.858">External: MCP Server</text><line style="stroke:#181818;stroke-width:0.5;" x1="931.99" x2="1102.0105" y1="729.8111" y2="729.8111"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.8311" x="936.99" y="747.3462">POST /mcp</text><line style="stroke:#181818;stroke-width:1;" x1="931.99" x2="1102.0105" y1="754.2994" y2="754.2994"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.0557" x="950.99" y="771.8345">JSON-RPC 2.0</text><ellipse cx="941.99" cy="784.5318" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.4277" x="950.99" y="788.3228">tools/list</text><ellipse cx="941.99" cy="801.0201" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.957" x="950.99" y="804.8111">tools/call</text></g><g class="entity" data-entity="GMN27" data-source-line="98" data-uid="ent0028" id="entity_GMN27"><path d="M666.34,714.85 L666.34,746.48 L631.79,750.48 L666.34,754.48 L666.34,786.0922 A0,0 0 0 0 666.34,786.0922 L797.6559,786.0922 A0,0 0 0 0 797.6559,786.0922 L797.6559,724.85 L787.6559,714.85 L666.34,714.85 A0,0 0 0 0 666.34,714.85" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M787.6559,714.85 L787.6559,724.85 L797.6559,724.85 L787.6559,714.85" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.3647" x="672.34" y="732.4184">Dependencies:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.9775" x="672.34" y="747.7289">- drakma (HTTP)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.3159" x="672.34" y="763.0395">- jonathan (JSON)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.687" x="672.34" y="778.35">- babel (UTF-8)</text></g><g class="entity" data-entity="GMN30" data-source-line="107" data-uid="ent0031" id="entity_GMN30"><path d="M1451.1,467.58 L1451.1,584.7538 A0,0 0 0 0 1451.1,584.7538 L1748.9022,584.7538 A0,0 0 0 0 1748.9022,584.7538 L1748.9022,477.58 L1738.9022,467.58 L1509.69,467.58 L1364.02,380.02 L1501.69,467.58 L1451.1,467.58 A0,0 0 0 0 1451.1,467.58" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1738.9022,467.58 L1738.9022,477.58 L1748.9022,477.58 L1738.9022,467.58" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.1582" x="1457.1" y="485.1484">Main Flow:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.3042" x="1457.1" y="500.4589">1. User input &#8594; REPL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.8022" x="1457.1" y="515.7695">2. REPL &#8594; Agent (run-mcp-ollama-session)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.5273" x="1457.1" y="531.08">3. Agent &#8594; MCP (get tools list)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.5166" x="1457.1" y="546.3905">4. Agent &#8594; Ollama (chat with tools)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.6182" x="1457.1" y="561.7011">5. If tool_calls &#8594; MCP (execute)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.3799" x="1457.1" y="577.0116">6. Loop until final answer</text></g><!--link REPL to Agent--><g class="link" data-entity-1="REPL" data-entity-2="Agent" data-source-line="75" data-uid="lnk12" id="link_REPL_Agent"><path codeLine="75" d="M1098.23,163.93 C1123.6,187.88 1148.5274,211.4108 1174.6874,236.1108" fill="none" id="REPL-to-Agent" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1179.05,240.23,1175.2522,231.1428,1175.4145,236.7974,1169.7599,236.9597,1179.05,240.23" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.5645" x="1144" y="207.1384">uses</text></g><!--link REPL to MCPHttpClient--><g class="link" data-entity-1="REPL" data-entity-2="MCPHttpClient" data-source-line="76" data-uid="lnk13" id="link_REPL_MCPHttpClient"><path codeLine="76" d="M997.23,163.76 C984.85,186.98 972.33,214.23 965,240.57 C942.79,320.44 936.83,345.14 952,426.64 C953.83,436.46 954.7253,440.8704 957.9553,450.6904" fill="none" id="REPL-to-MCPHttpClient" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="959.83,456.39,960.8177,446.5908,958.2677,451.6403,953.2182,449.0904,959.83,456.39" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.791" x="966" y="315.1784">:tools command</text></g><!--link Agent to OllamaClient--><g class="link" data-entity-1="Agent" data-entity-2="OllamaClient" data-source-line="78" data-uid="lnk14" id="link_Agent_OllamaClient"><path codeLine="78" d="M1085.13,371.17 C1075.98,374.12 1066.89,376.96 1058,379.64 C930.39,418.09 790.7588,453.1984 677.4188,480.0184" fill="none" id="Agent-to-OllamaClient" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="671.58,481.4,681.2592,483.22,676.4456,480.2486,679.417,475.435,671.58,481.4" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.1543" x="949.03" y="423.2084">calls LLM</text></g><!--link Agent to MCPHttpClient--><g class="link" data-entity-1="Agent" data-entity-2="MCPHttpClient" data-source-line="79" data-uid="lnk15" id="link_Agent_MCPHttpClient"><path codeLine="79" d="M1167.66,380.02 C1137.74,404.46 1108.7369,428.1645 1078.8269,452.5945" fill="none" id="Agent-to-MCPHttpClient" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1074.18,456.39,1083.6807,453.7947,1078.0524,453.2271,1078.62,447.5987,1074.18,456.39" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.4712" x="1129.86" y="423.2084">retrieves/calls tools</text></g><!--link Agent to Configuration--><g class="link" data-entity-1="Agent" data-entity-2="Configuration" data-source-line="80" data-uid="lnk16" id="link_Agent_Configuration"><path codeLine="80" d="M1260.67,379.93 C1261.64,389.88 1262.46,400.01 1263,409.64 C1268.02,499.77 1266.174,597.5538 1263.714,666.4838" fill="none" id="Agent-to-Configuration" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="1263.5,672.48,1267.8184,663.6284,1263.6783,667.4832,1259.8235,663.3431,1263.5,672.48" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34.5503" x="1267.08" y="531.2384">reads</text></g><!--link Agent to Logging--><g class="link" data-entity-1="Agent" data-entity-2="Logging" data-source-line="81" data-uid="lnk17" id="link_Agent_Logging"><path codeLine="81" d="M1307.03,379.99 C1385.93,487.55 1510.15,696.67 1400,828.25 C1327.83,914.46 982.0568,934.5146 837.8468,939.2146" fill="none" id="Agent-to-Logging" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="831.85,939.41,840.9755,943.1147,836.8473,939.2471,840.7149,935.119,831.85,939.41" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.4761" x="1437.86" y="639.2684">logs</text></g><!--link OllamaClient to HttpUtils--><g class="link" data-entity-1="OllamaClient" data-entity-2="HttpUtils" data-source-line="83" data-uid="lnk18" id="link_OllamaClient_HttpUtils"><path codeLine="83" d="M478,587.91 C478,622.11 478,658.38 478,691.11" fill="none" id="OllamaClient-to-HttpUtils" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="478,697.11,482,688.11,478,692.11,474,688.11,478,697.11" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.7988" x="479" y="639.2684">HTTP POST</text></g><!--link OllamaClient to Configuration--><g class="link" data-entity-1="OllamaClient" data-entity-2="Configuration" data-source-line="84" data-uid="lnk19" id="link_OllamaClient_Configuration"><path codeLine="84" d="M671.47,581.11 C771.66,608.83 878.03,637.81 902,642.7 C998.26,662.32 1027.76,641.76 1121,672.7 C1126.49,674.52 1126.4498,674.3299 1131.9698,676.5399" fill="none" id="OllamaClient-to-Configuration" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="1137.54,678.77,1130.6715,671.7114,1132.8982,676.9116,1127.698,679.1383,1137.54,678.77" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8569" x="903" y="639.2684">reads *ollama-url*</text></g><!--link OllamaClient to Logging--><g class="link" data-entity-1="OllamaClient" data-entity-2="Logging" data-source-line="85" data-uid="lnk20" id="link_OllamaClient_Logging"><path codeLine="85" d="M284.36,548.78 C205.99,568.13 122.87,604.51 75,672.7 C35.28,729.28 30.19,775.6 75,828.25 C156.25,923.72 547.5105,938.3789 702.1905,940.4689" fill="none" id="OllamaClient-to-Logging" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="708.19,940.55,699.2449,936.4288,703.1905,940.4824,699.1368,944.428,708.19,940.55" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.4761" x="76" y="755.5484">logs</text></g><!--link MCPHttpClient to HttpUtils--><g class="link" data-entity-1="MCPHttpClient" data-entity-2="HttpUtils" data-source-line="87" data-uid="lnk21" id="link_MCPHttpClient_HttpUtils"><path codeLine="87" d="M826.69,596.14 C770.3,620.14 706.78,647.4 649,672.7 C631.26,680.47 618.0088,686.324 599.7088,694.494" fill="none" id="MCPHttpClient-to-HttpUtils" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="594.23,696.94,604.0788,696.9235,598.7957,694.9017,600.8175,689.6185,594.23,696.94" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.7988" x="752.86" y="639.2684">HTTP POST</text></g><!--link MCPHttpClient to Configuration--><g class="link" data-entity-1="MCPHttpClient" data-entity-2="Configuration" data-source-line="88" data-uid="lnk22" id="link_MCPHttpClient_Configuration"><path codeLine="88" d="M1073.58,595.99 C1103.01,620.21 1131.6382,643.786 1161.8282,668.646" fill="none" id="MCPHttpClient-to-Configuration" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="1166.46,672.46,1162.055,663.6511,1162.6002,669.2816,1156.9697,669.8268,1166.46,672.46" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.8384" x="1126" y="639.2684">reads *mcp-url*</text></g><!--link MCPHttpClient to Logging--><g class="link" data-entity-1="MCPHttpClient" data-entity-2="Logging" data-source-line="89" data-uid="lnk23" id="link_MCPHttpClient_Logging"><path codeLine="89" d="M896.95,596.01 C888.02,605.27 879.79,615.22 873,625.7 C822.08,704.29 845.31,739.65 815,828.25 C806.11,854.24 796.9025,877.4436 787.7425,899.3736" fill="none" id="MCPHttpClient-to-Logging" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="785.43,904.91,792.5898,898.147,787.3571,900.2963,785.2078,895.0636,785.43,904.91" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.4761" x="849.64" y="755.5484">logs</text></g><!--link HttpUtils to Logging--><g class="link" data-entity-1="HttpUtils" data-entity-2="Logging" data-source-line="91" data-uid="lnk24" id="link_HttpUtils_Logging"><path codeLine="91" d="M558.95,803.96 C608.57,836.14 665.766,873.2152 709.756,901.7452" fill="none" id="HttpUtils-to-Logging" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="714.79,905.01,709.4156,896.7568,710.595,902.2893,705.0625,903.4688,714.79,905.01" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.4761" x="668.22" y="871.8184">logs</text></g><!--link OllamaClient to External: Ollama API--><g class="link" data-entity-1="OllamaClient" data-entity-2="External. Ollama API" data-source-line="93" data-uid="lnk25" id="link_OllamaClient_External. Ollama API"><path codeLine="93" d="M403.4,587.91 C368.2,616.58 330.6727,647.1416 294.2827,676.7716" fill="none" id="OllamaClient-to-External: Ollama API" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="289.63,680.56,299.1347,677.9792,293.5073,677.403,294.0835,671.7756,289.63,680.56" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.501" x="350.69" y="639.2684">REST API</text></g><!--link MCPHttpClient to External: MCP Server--><g class="link" data-entity-1="MCPHttpClient" data-entity-2="External. MCP Server" data-source-line="94" data-uid="lnk26" id="link_MCPHttpClient_External. MCP Server"><path codeLine="94" d="M1021.05,596.17 C1024.33,605.92 1027.14,615.94 1029,625.7 C1032.88,646.06 1032.8848,662.5927 1030.4648,682.7627" fill="none" id="MCPHttpClient-to-External: MCP Server" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="1029.75,688.72,1034.7936,680.2606,1030.3456,683.7556,1026.8506,679.3076,1029.75,688.72" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.6704" x="1032.18" y="639.2684">JSON-RPC</text></g><!--SRC=[ZLPTSjis47xNAH3t8NHYo6sQT19DnZEs8YLk5KlZd-SCI48K4X1W032sffFN7g2tw3bwavwakm0eaHBjU8OFmEwtYsyNkmi-oVbIA4uMf-C_JjzFFetdi_ab-MdoUlfgycRm96h7izEhgqPtTlPkCZtRwAOt5-Fhy_b5evvEfs_6BmU3YcLVMC79GPbLD9E2AtT0thvT1F79oSwHVmu8WI-Jp5foCDPgAOhQC2UqGhFtKgTCaWKphEIE6miEq8IGvy-qbAnaj3Ro6HaHwunGHLTLwfplAv5Odn7GKuxQjNMyf9NHPUNsC3bFwmAbgTQICzLogVYTeo97fL2E5zo0ydidlCl9OePHdOFUB5c6wMZdE4PcQaNHOup2y4ecWSzX09HCg2IiwOgfN79QMsweK5Nj4WdNqrLckYnXPPEuEDnZTbh4Uu8RS0OEvkPHt2ot5gugsHv_k9Co15UmTTH1ocn3Ews5p6a9vf1skXBMQRDEujv640ITWSHRqen9CDyk8uRVyQnsV8lPGlR3d7lMuqrLdYxEITZrHujUcb1lXLl561gQHyJlCUGLiw1bgUJRiBsIdaJxQDh8qKX2s05UCMCvPQQeIo1ZQSdMAKzWt-kSAriRJj4ykMivwWRxSRpuu5pr-6YHsmeieEA-rXnyGykjT7v4Aco_7uJfoNI3wYgfWmQ12bIAYa9fm_DzjC-tlpyFLj3qHmIpG1a2TsgBjjhE7trVts4QRfoG5hE02-7M_IdmuLSQs7wsMDP6OlHhgLdUI-5vglCrFGcI13Ux76CBnhpQIYlB4-kOgw5ylC4UtPak2h3_8TayBP9bwKA6Mcv4Crx8mUGEbeh94GcbJw06q6yZ9rVSV1D-40MdY_dLDJbcbJZELYpS3ANnWd2QxdPtx0GGCsFOEaZzfNT5OCHPsHcS3x65slNKk7a4MoY3Dj7Vh-ONz78n9Y-6FxVu76zBBUonsBOqdf9BBlsxOs67anhydH0_684s3BYElDDSe1-5cEE03Iw3BQBRSmV0VdwHsUnZ1xJhqd18DF_60rCRPit6OZY4ccW_bzw2vLr4B2LiD5tOGAj31W_Uj0V0FbnVBtnQTu7tdaVQ3t6VLH-7RgmFaUWY7s3HFEkzDdqSjYS-AbC8kgUVHb0NK8YmxZtydheURIgrgS1tlE8gvoeJq57S6_cgKzfnOaInSaGljxnzCRTjHg4DI6xO5-2MO1xZCqa-QyKS32EIuAcDD6Kfz7HoSpsbhr46hlnfW- -3mLCobVKToJd9OMZ_-mzmmeSy4nMJ0qyfrSxf4ZdvYiFWuSy4pFGjKlbbI6xWlu3u_mBotrz_-_O1nOjXQ2GKXLfD-lyhaDAlmuX1DEOlARWBpU1V3yIyR6FYpIGum0Y-sl6L1joh8JbV-ksdq5CRd_4t0a6_3Q4OT4Lg1KacyBCBWuSfUmiFooOz_mC0]--></g></svg>